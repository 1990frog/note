<!-- TOC -->

- [角色](#%E8%A7%92%E8%89%B2)
- [国家类上报统计](#%E5%9B%BD%E5%AE%B6%E7%B1%BB%E4%B8%8A%E6%8A%A5%E7%BB%9F%E8%AE%A1)
- [首页](#%E9%A6%96%E9%A1%B5)
- [数据上报](#%E6%95%B0%E6%8D%AE%E4%B8%8A%E6%8A%A5)
- [数据审核](#%E6%95%B0%E6%8D%AE%E5%AE%A1%E6%A0%B8)
- [校验规则关联](#%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99%E5%85%B3%E8%81%94)
- [规则](#%E8%A7%84%E5%88%99)
    - [type1：日期类型操作](#type1%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E6%93%8D%E4%BD%9C)

<!-- /TOC -->
# 角色
医联体用户——角色绑定医院

# 国家类上报统计
+ 每月都需要上报？
+ 上报有窗口期
+ 上报方式：页面，excel导入
+ 是否需要配置伪码校验？

# 首页
+ 上报是以任务方式每月生成？

# 数据上报
+ 两张报表：上报卫统1-8，上报HQMS
+ 上报模式两种？导入，手填
+ 保存（暂存）触发校验？数据存在问题怎么修改？重新导入？还是页面修改？
+ 提交的前提是什么？
+ 数据量大概是多少？
+ 是否只有hqms需要核查？
+ 操作是pdf展示？

# 数据审核
+ 国家类上报不需要审核吗？
+ 不通过流程怎么走？

# 校验规则关联
+ 版本迭代
+ 规则大类

# 规则

## type1：日期类型操作
年龄 = (入院时间 - 出生日期）
```haskell
格式校验：
    入院时间 is DateTime
    出生日期 is DateTime

逻辑校验：
    年龄 = day(入院时间)/365 - day(出生日期)/365
```

入院时间<=出院时间 and (入院时间-1)<=手术操作日期 and 手术操作日期<=出院时间
```haskell
格式校验：
入院时间 is DateTime
出生日期 is DateTime

逻辑校验：
    rule1
        item1: 入院时间 <= 出院时间
        item2: 入院时间 <= 手术操作日期 + 1
        item3: 手术操作日期 <= 出院时间

判断条件 = (格式校验) && (逻辑校验)
        = (格式校验) && (item1 && item2 && item3)
```





(ascll(substr(诊断编码,0,1))>= 65 and ascll(substr(诊断编码,0,1))<= 85) or (ascll(substr(诊断编码,0,1))>= 97 and ascll(substr(诊断编码,0,1))<= 117) or 诊断编码 like '%Z' or 诊断编码 like '%z'


(诊断编码 like 'P10%' or 诊断编码 like 'P11%' or 诊断编码 like 'P12%' or 诊断编码 like 'P13%' or 诊断编码 like 'P14%' or 诊断编码 like 'P15%')  and (入院时间-出生日期）<=28 and 年龄不足1周岁的年龄（天）<=28


(诊断编码 like '%080%' or 诊断编码 like '%081%' or 诊断编码 like '%082%' or 诊断编码 like '%083%%' or 诊断编码 like '%084%') and (无流产结局编码 like '%000%' or 无流产结局编码 like '%001%' or 无流产结局编码 like '%002%' or 无流产结局编码 like '%003%%' or 无流产结局编码 like '%004%'or 无流产结局编码 like '%005%' or 无流产结局编码 like '%006%' or 无流产结局编码 like '%007%' or 无流产结局编码 like '%008%') and 出院其他诊断编码 like '%Z37'


(ascll(substr(ICD-10编码,0,1))>= 86 and ascll(substr(ICD10编码,0,1))<= 85) or (ascll(substrICD-10编码,0,1))>= 118 and ascll(substr(ICD-10编码,0,1))<= 121)


((诊断编码 like '%Z37.0' or 诊断编码 like '%Z37.2' or 诊断编码 like '%Z37.3' or 诊断编码 like '%Z37.5' or 诊断编码 like '%Z37.6') or (入院时间-出生日期）<=28 or 年龄不足1周岁的年龄（天）<=28 ) and 新生儿出生体重 <>'空'   


(入院时间-出生日期）<=28 or 年龄不足1周岁的年龄（天）<=28 ) and 新生儿体重 <>'空' 


"住院总费用 <> '空' amd 住院总费用 >=0 
and 住院总费用 >= 分项费用之和"


(substr(出院主要诊断编码,0,1)='C' or 出院主要诊断编码 like '%D00%' or 出院主要诊断编码 like '%D01%' or  出院主要诊断编码 like '%D02%' or  出院主要诊断编码 like '%D03%' or  出院主要诊断编码 like '%D04%' or  出院主要诊断编码 like '%D05%' or  出院主要诊断编码 like '%D06%' or  出院主要诊断编码 like '%D07%' or  出院主要诊断编码 like '%D08%' or  出院主要诊断编码 like '%D09%' or  出院主要诊断编码 like '%D10%' or  出院主要诊断编码 like '%D45%' or  出院主要诊断编码 like '%D46%' or  出院主要诊断编码 like '%D47%')) and 病理诊断编码 <> '空' and 病理诊断名称 <> '空'


(出院主要诊断ICD编码 like 'S%' or 出院主要诊断ICD编码 like 'T%' or 出院主要诊断ICD编码 like 's%' or 出院主要诊断ICD编码 like 't%') and 损伤、中毒外部原因编码 <> '空' and 损伤、中毒外部原因名称 <> '空'


主要手术操作编码 in (手术代码 or 介入治疗代码) and 主要手术操作级别 <> '空' and 主要手术操作Ⅰ助 <> '空' and 主要手术操作Ⅱ助 <> '空' 


"(性别 = '男' and len(身份证号码) =15 
and isdate (substr(身份证号码,7,6))=1 
and 
(
 mod
 （
  substr
  ( 
   身份证号,-2,1
  ),2
 )=1
)  ) or (性别 = '女' and len(身份证号码) =15 
and isdate (substr(身份证号码,7,6))=1 
and 
(
 mod
 （
  substr
  ( 
   身份证号,-2,1
  ),2
 )=0
)  ) or (性别 = '男' and len(身份证号码) =18
and isdate (substr(身份证号码,7,8))=1 
and 
(
 mod
 （
  substr
  ( 
   身份证号,-2,1
  ),2
 )=1
)  ) or(性别 = '女' and len(身份证号码) =18
and isdate (substr(身份证号码,7,8))=1 
and 
(
 mod
 （
  substr
  ( 
   身份证号,-2,1
  ),2
 )=0
)  ) "



"(入院日期(日期)=<手术操作日期1=<出院日期(日期))
and
((入院日期(日期)=<手术操作日期2=<出院日期(日)
…
and
((入院日期(日期)=<手术操作日期7=<出院日期(日)
"


(select left(主要诊断编码,3) == S06)and（颅脑损伤患者昏迷时间 is not null）

---





substart(len(a+b+c),0,3) > len(c)





---

{"gt":{"lval":{"script":{"type":"substart","val":{"add":{"lval":{"add":{"lval":"a","rval":"b"}},"rval":"c"}}}},"rval":20}}

{
    "gt":{
        "lval":{
            "script":{
                "type":"substart",
                "val":{
                    "add":{
                        "lval":{
                            "add":{
                                "lval":{"type":"field","val":"a"},
                                "rval":{"type":"field","val":"b"}
                            }
                        },
                        "rval":"c"
                    }
                }
            }
        },
        "rval":20
    }
}



