[TOC]

#  任务处理现状
搭建Hadoop集群，实现了离线数仓的基础框架
编写HQL定时对数据进行计算，生成T+1的离线数据
不同的任务编写成不同的HQL文件，通过Crontab进行调度

# 任务处理现状
安排几十个计算的先后顺序，避免顺序颠倒导致计算错误
一个任务失败，后续任务全部等待，效率很低
任务太多，串行执行时间太长

# 任务处理场景
原始数据为业务数据库 or FTP存储的文件类型数据
通过shell脚本或者hadoop工具，将数据存储到HDFS
通过MapReduce任务对HDFS上的原始数据进行转换，以分区表的形式存储到多张Hive表
对hive中多个表的数据进行join处理，得到一个明细数据Hive大表
将明细数据进行复杂的统计分析，得到结果报表信息
将统计分析得到的结果数据同步到业务系统中，供业务调用使用

# 任务处理需求
分解计算任务，支持shell脚本任务，java程序，mapreduce程序、hive脚本等
各任务单元之间存在时间先后及前后依赖关系，前置任务失败，后续依赖任务不执行
很好地对任务进行编排组织复杂执行计划，定时触发计算任务，任务失败进行报警

# 调度系统功能
用户可以方便的定义一个作业流程都包括哪些作业及依赖关系
管理工作流的生命周期，定时执行任务，支持Cron表达式
支持各种依赖条件的判断及后续任务执行的触发操作
对异常作业有完善的对应措施，比如重试、报警
支持资源和权限的控制，最好支持任务优先级
对调度系统本身及工作流有完善的监控，便于排查问题及协助数据治理

# 开源调度框架
Linux Crontab：针对个人用户及小任务量
Apache Oozie：功能强大，配置复杂的hadoop任务调度框架
Azkaban：开源的工作流管理器，轻量级调度框架
AirFlow：基于Python开发的通用批处理调度框架
Zenus：阿里开源的基于hadoop的工作流调度系统
EasyScheduler：国内开源的分布式工作流任务调度系统

![](_v_images/20200907201932208_32067.png)

# Azkaban介绍
Linkedin公司开源的分布式批量工作流任务调度器
通过简单的KV的方式，生成job，并构建依赖关系
通过插件化的任务提交模块，支持可扩展的多任务提交

# Azkaban适用场景
通过Azkaban结合Datax实现定时的数据采集服务
通过Azkaban调度执行shell、java、hive、hadoop等任务
开发可复用的程序、通过azkaban编排成工作流，执行批处理任务
对Azkaban进行二次开发通过接口创建任务、调度任务、管理任务
将Azkaban作为数据平台的一部分，提供任务调度的能力
基于Azkaban的异常处理、监控警报、审计日志完善数据平台功能

# Azkaban架构
AzkabanServer：Azkaban的管理服务，提供WebUI，负责Project管理、权限管理、定时执行、跟踪进度、审计日志等等功能
AzkabanExecutor：负责工作流的提供和执行，搜集执行日志
MySQL：存储工作流详情及节点和任务的状态信息等