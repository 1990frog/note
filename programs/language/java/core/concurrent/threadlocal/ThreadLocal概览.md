[TOC]

ThreadLocal定义线程独有资源，其存放在Thread内的ThreadLocalMap容器内
ThreadLocal存放于堆中，但是可以实现线程隔离

优势：
不用考虑并发，一对一

![](https://gitee.com/caijingquan/imagebed/raw/master/1602317738_20200106170347430_1504130535.png)
# Threadlocal
ThreadLocal类顾名思义可以理解为线程本地变量。也就是说如果定义了一个ThreadLocal，每个线程往这个ThreadLocal中读写是线程隔离，互相之间不会影响的。
它提供了一种将可变数据通过每个线程有自己的独立副本从而实现线程封闭的机制。

# 优点
1. 达到线程安全【单线程】
2. 不需要加锁，提高执行效率【不需要排队】
3. 更高效地利用内存、节省开销：相比于每个任务都新建一个SimpleDateFormat，显然用ThreadLocal可以节省内存和开销【单线程单例】
4. 免去传参的繁琐：无论是场景一的工具类，还是场景二的用户名，都可以在任何地方直接通过ThreadLocal拿到，再也不需要每次都传同样的参数。ThreadLocal使得代码耦合度低，更优雅【打破栈封闭，每个方法不要传值传来传去了】

# java四种引用类型
1. 强引用：如果JVM垃圾回收器GC Roots可达性分析结果为可达，表示引用类型仍然被引用着，这类对象始终不会被垃圾回收器回收，即使JVM发生OOM也不会回收。而如果GC Roots的可达性分析结果为不可达，那么在GC时会被回收
2. 软引用：在JVM内存充足的情况下，软引用并不会被垃圾回收器回收，只有在JVM内存不足的情况下，才会被垃圾回收器回收
3. 弱引用：弱引用是一种比软引用生命周期更短的引用。它的生命周期很短，不论当前内存是否充足，都只能存活到下一次垃圾收集之前
4. 虚引用：随时可被回收




