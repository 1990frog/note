[TOC]

# 目的
+ 限流远比你想的要多
+ 系统活着比挂了要好
+ 宁愿只让少数人能用，也不要让所有人不能用

# 方案
+ 限并发
+ 令牌桶算法
+ 漏桶算法

## 限并发
controller全局计数器，线程池，信号量
## 令牌桶算法
客户端：获取令牌
令牌桶：持有令牌，每秒10个
定时器：每秒往桶内放置10个令牌
## 漏桶算法
桶：存10碗水，每秒以1滴水的速度流出
客户端：向桶中加水，如果桶是满的，那就溢出

# 限流粒度
+ 接口维度
+ 总维度

# 限流范围
+ 集群限流：依赖redis或其他的中间件技术做统一计数器，往往会产生性能瓶颈
+ 单机限流：负责均衡的前提下单机平均限流效果更好

集群限流（redis）会产生网络开销，使用不当为成为系统性能的瓶颈，所以大部分情况下会采用单机的限流，这个前提条件是负载均衡度做的好

